{% extends "auctions/layout.html" %}

{% block body %}
<div class="container">
    <div class="row">
        <div class="col-10">
            <h1>Listing {{ listing.title }}</h1>
            {% if listing.image %}
            <img src="{{ listing.image.url }}" alt="{{ listing.title }}"
            class="img-thumbnail size-400">
            {% endif %}
            <p>{{ listing.description }}</p>
            <p class="text-secondary"><small>Created {{ listing.date_created }}</small></p>
        </div>
    </div>
    <div class="row">
        <div class="col-10">
            <h2>$
                {% if listing.highest_bid %}
                {{ listing.highest_bid.price }}
                {% else %}
                {{ listing.price }}
                {% endif %}
            </h2>
            <p>
                {{ bidder_count }}
                {% if bidder_count == 1 %}
                 bid
                {% else %}
                 bids
                {% endif %}
                 so far.
                {% if highest_bidder %}
                    {% if highest_bidder.id == user.id %}
                    Your
                    {% else %}
                    {{ highest_bidder.username }}'s
                    {% endif %}
                     bid is the the current bid.
                {% endif %}
            </p>
            {% if messages %}
            {% for message in messages %}
            <div class="alert alert-danger" role="alert">
                    {{ message }}
            </div>
            {% endfor %}
            {% endif %}
            <form action="{% url 'auctions:listing' listing_id=listing.id %}" method="POST">
                {% csrf_token %}
                <div class="form-group">
                    {{ bid_form }}
                </div>
                <input type="submit" class="btn btn-primary" value="Place Bid">
            </form>
            <a href="{% url 'auctions:watch' listing_id=listing.id %}"
            class="btn btn-light">
            {% if watching %}
            Remove from
            {% else %}
            Add to
            {% endif %}
             watchlist
            </a>
        </div>
    </div>
    <div class="row">
        <div class="col-10">
            <h3>Details</h3>
            <ul>
                <li>Listed by: {{ listing.creator.username }}</li>
                <li>Category: {{ listing.category.name }}</li>
            </ul>
        </div>
    </div>
</div>
{% endblock %}